<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="keep fighting！">
<meta property="og:type" content="website">
<meta property="og:title" content="JiM-W">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="JiM-W">
<meta property="og:description" content="keep fighting！">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JiM-W">
<meta name="twitter:description" content="keep fighting！">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/4/"/>





  <title> JiM-W </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JiM-W</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">keep Moving</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/18/181svn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/18/181svn/" itemprop="url">
                  svn
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-18T12:36:00+08:00">
                2017-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、SVN工作原理"><a href="#一、SVN工作原理" class="headerlink" title="一、SVN工作原理"></a>一、SVN工作原理</h2><p>SVN（SubVersion）的基本工作思路是这样的：在一台服务器上建立一个源代码库，库里可以存放许多不同项目的源程序，由源代码库管理员统一管理这些源程序。</p>
<p>每个用户在使用源代码库之前，首先要把源代码库里的项目文件下载到本地（Checkout），然后用户可以在本地任意修改，最后用svn命令进行提交（Commit），由svn源代码库统一管理修改;update可以更新服务器上的最新的代码；</p>
<ul>
<li><strong>SVN服务器：</strong>运行SubVersion服务的计算机，SubVersion支持Linux和Windows，更多的是安装在Linux下。SVN提供服务有两种方式（运行方式）：独立服务器和借助Apache服务器，分别使用SVN协议和Http协议。</li>
<li><strong>SVN客户端：</strong>用户通过SVN客户端同SVN服务器打交道，SVN客户端分为命令行工具和图形化工具。最流行的客户端是TortoiseSVN。也可以在Eclipse中使用SVN插件。</li>
</ul>
<h2 id="二、SubVersion的使用"><a href="#二、SubVersion的使用" class="headerlink" title="二、SubVersion的使用"></a>二、SubVersion的使用</h2><p>shift+右键   可以直接在摸个目录打开终端命令行</p>
<p><strong>1、创建SVN仓库</strong></p>
<p>1）先创建一个目录：E:\svnrepo\repoDemo1。后面就使用该目录作为SVN仓库。</p>
<p>2）创建仓库：svnadmin create E:\svnrepo\repoDemo1。</p>
<p>3）启动SVN服务：svnserve -d -r E:\svnrepo\repoDemo1，</p>
<p>这样就启动了repoDemo1这个仓库的服务（单仓库），如果在svnrepo目录下还有其他仓库，且要同时启动多个仓库，执行svnserve -d -r E:\svnrepo即可（多仓库）。</p>
<p>注：-d参数效果同于-daemon<br>-r参数效果同于-root<br>svnserve 将会在端口 3690 等待请求，-daemon（两个短横线）告诉 svnserve 以守护 进程方式运行，这样在手动终止之前不会退出。不要关闭命令行窗口，关闭窗口会把 svnserve 停止。-root设置根位置来限制服务器的访问目录，从而增加安全性和节约输入svnserve URL的时间。<br>如果不加root参数，服务url为：svn://192.168.1.188/svnrepo/repoDemo1<br>如果加上root参数，服务url为：svn://192.168.1.188/repoDemo1<br>此处的启动配置会影响服务url，如果输入url错误，会导致访问的时候出现异常。</p>
<p>一般情况下，访问SVN仓库的URL格式形如：svn://192.168.1.6/repoDemo1，但如果启动的是单仓库，则URL直接用：svn://192.168.1.6表示。svn协议的默认端口号为3690。</p>
<p><strong>2、SVN客户端操作（命令行）</strong></p>
<p><strong>重点：checkout（检出）、commit（提交）、update（更新）</strong></p>
<p>1）在E盘下建立user1、user2两个目录，模拟两个协同工作的用户的workspace。</p>
<p>2）<strong>检出：第一次</strong>和SVN服务器交互时，需要使用checkout将仓库检出到本地。</p>
<p><strong>说明：</strong>检出一次，就建立了与SVN仓库的连接。</p>
<p>3）<strong>提交：commit</strong></p>
<p>在user1目录下新建Demo1.java文件，将该文件提交到SVN仓库，提交之后，别人就可以从这个源代码库进行更新代码了</p>
<p>4）<strong>更新：update</strong></p>
<p>切换到user2的工作空间（user2目录下），user2第一次使用SVN仓库，需要检出。user2修改Demo1.java后提交。切换到user1目录，更新（update）。</p>
<p>5）启动SVN服务。这步需要在命令行中输入：svnserve -d -r E:\svnrepo</p>
<p>6）访问SVN仓库。在任意空白位置右击 — TortoiseSVN — Repo browser，URL输入：svn://192.168.1.6/repoDemo2即可浏览SVN仓库中的内容</p>
<h2 id="三、SVN的目录约定"><a href="#三、SVN的目录约定" class="headerlink" title="三、SVN的目录约定"></a>三、SVN的目录约定</h2><ul>
<li><strong>/trunck：</strong>开发主线</li>
<li><strong>/branches：</strong>支线副本</li>
<li><strong>/tags：</strong>标签副本（一旦创建，不允许修改）</li>
</ul>
<p><strong>1 使用trunk作为主要的开发目录</strong></p>
<p>一般的，我们的所有的开发都是基于trunk进行开发，当一个版本（release）开发告一段落（开发、测试、文档、制作安装程序、打包等结束后），代码处于冻结状态（人为规定，可以通过hook来进行管理）。此时应该基于当前冻结的代码库，打tag。</p>
<p>当下一个版本/阶段的开发任务开始时，继续在trunk进行开发。此时，如果发现了上一个已发行版本（Released Version）有一些bug，或者一些很急迫的功能要求，而正在开发的版本（Developing Version）无法满足时间要求，这时候就需要在上一个版本上进行修改了。解决方法是基于发行版对应的tag，做相应的分支（branch）进行开发。</p>
<p><strong>2、其他操作</strong></p>
<p><strong>下面的操作都位于右键菜单的TortoiseSVN中。</strong></p>
<p>1）删除：delete</p>
<p>删除文件或目录，不能直接用Windows的删除命令来操作，那样只是没有显示出来，实际并没有删除，在更新后，删除的文件又会被更新出来的。要想从库中 删除，必须选中你要删除的内容，TortoiseSVN — delete，这样才会将这个文件标记成要删除的。<strong>确认需要删除后，使用前面所讲的提交命令，就会真正的在库中删除了。</strong>否则版本库中依旧存在这原先的代码</p>
<p>2）重命名：rename</p>
<p>重命名也不能直接用Windows的重命名命令来操作，必须选中你要重命名的文件，TortoiseSVN — rename。修改后提交就可以更新到仓库。</p>
<p>改名的处理方式相当于新增了一个以新名称命名的文件，原名称命名的文件进行了删除。</p>
<p><strong>3）还原：revert</strong></p>
<p>在未提交之前，你对前面做的操作反悔了，可以使用revert来恢复。</p>
<p><strong>4）检查更新：Check for modifications</strong></p>
<p>① 此功能可以显示你所做的修改有哪些还没有提交的。② 还可以看到版本库里的改动，即别人提交了哪些文件的改动，你还没更新到本地。</p>
<p><strong>5）导出：export</strong></p>
<p>使用SVN的工作空间每个目录下面都有一个.svn隐藏目录，利用SVN的export命令可轻松地导出不含.svn目录的工作空间。</p>
<p><strong>3、冲突问题的解决（☆）</strong></p>
<p><strong>何时发生：</strong>假设user3和user4目录下的Demo1.java都更新到了最新版本号100。user3修改Demo1.java，提交至仓库，此时显示提交成功，这个时候Demo.java文件版本号变成了101。若 user4也修改Demo1.java并提交(在版本号为100的上面进行文件修改，由于不是在最新的101版本号上进行的修改和提交，所以显示提交失败)，此时user4的TortoiseSVN会报提交版本过时的错误，并提醒user4需要更新，更新时就会发 生冲突。</p>
<p><strong>如果两个程序员同时修改了同一个文件呢, SVN可以合并这两个程序员的改动，实际上SVN管理源代码是以行为单位的，就是说两个程序员只要不是修改了同一行程序，SVN都会自动合并两种修改。如果是同一行，SVN会提示文件Confict, 冲突，需要手动确认。</strong></p>
<p>也就是说，如果两个人同时修改了文件，然后同时进行提交，那么就会出现冲突，解决冲突的办法就是编辑冲突，或者在另外一个人提交之后，先update到最新版本，然后进行文件修改。</p>
<p>对于每个更新冲突的文件，Subversion会在冲突文件所在目录下放置了三个文件：</p>
<ul>
<li>Demo1.java.mine：发生冲突时的本地版本。</li>
<li>Demo1.java.r3：最后更新之后的本地版本。</li>
<li>Demo1.java.r4：仓库中的最新版本。</li>
</ul>
<p><strong>解决方法 1：</strong></p>
<p>① 在Demo1.java上右击 — TortoiseSVN — Edit conflicts，这时你需要确定哪些代码是需要的，做一些必要的修改然后保存。小技巧：编辑冲突时，可使用直接复制需要的代码到Merged窗口即可。</p>
<p>② 编辑完成后保存，直接选择Mark as resolved，即标记为冲突已解决。退出编辑冲突窗口，发现冲突发生时生成的三个文件被自动删除了，且Demo1.java变成了未提交状态。</p>
<p>③ commit，OK。</p>
<p><strong>解决方法 2：</strong></p>
<p>直接修改Demo1.java，把其中的一些标记删除即可（前提是服务器上的和本地的内容都需要保存）。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/18/183react-元素渲染和组件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/18/183react-元素渲染和组件/" itemprop="url">
                  react 元素渲染和组件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-18T12:36:00+08:00">
                2017-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react/" itemprop="url" rel="index">
                    <span itemprop="name">react</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="react特点"><a href="#react特点" class="headerlink" title="react特点"></a>react特点</h3><ul>
<li><strong>1.声明式设计</strong> −React采用声明范式，可以轻松描述应用。</li>
<li><strong>2.高效</strong> −React通过对DOM的模拟，最大限度地减少与DOM的交互。</li>
<li><strong>3.灵活</strong> −React可以与已知的库或框架很好地配合。</li>
<li><strong>4.JSX</strong> − JSX 是 JavaScript 语法的扩展。React 开发不一定使用 JSX ，但我们建议使用它。</li>
<li><strong>5.组件</strong> − 通过 React 构建组件，使得代码更加容易得到复用，能够很好的应用在大项目的开发中。</li>
<li><strong>6.单向响应的数据流</strong> − React 实现了单向响应的数据流，从而减少了重复代码，这也是它为什么比传统数据绑定更简单。</li>
</ul>
<h3 id="React的原理"><a href="#React的原理" class="headerlink" title="React的原理"></a>React的原理</h3><p>在Web开发中，我们总需要将变化的数据实时反应到UI上，这时就需要对DOM进行操作。而复杂或频繁的DOM操作通常是性能瓶颈产生的原因（如何进行高性能的复杂DOM操作通常是衡量一个前端开发人员技能的重要指标）。React为此引入了虚拟DOM（Virtual DOM）的机制：在浏览器端用Javascript实现了一套DOM API。基于React进行开发时所有的DOM构造都是通过虚拟DOM进行，每当数据变化时，React都会重新构建整个DOM树，然后React将当前整个DOM树和上一次的DOM树进行对比，得到DOM结构的区别，然后仅仅将需要变化的部分进行实际的浏览器DOM更新。而且React能够批处理虚拟DOM的刷新，在一个事件循环（Event Loop）内的两次数据变化会被合并，例如你连续的先将节点内容从A变成B，然后又从B变成A，React会认为UI不发生任何变化，而如果通过手动控制，这种逻辑通常是极其复杂的。尽管每一次都需要构造完整的虚拟DOM树，但是因为虚拟DOM是内存数据，性能是极高的，而对实际DOM进行操作的仅仅是Diff部分，因而能达到提高性能的目的。这样，在保证性能的同时，开发者将不再需要关注某个数据的变化如何更新到一个或多个具体的DOM元素，而只需要关心在任意一个数据状态下，整个界面是如何Render的。</p>
<h3 id="1-HTML-标签-vs-React-组件"><a href="#1-HTML-标签-vs-React-组件" class="headerlink" title="1 HTML 标签 vs. React 组件"></a>1 HTML 标签 vs. React 组件</h3><p>React 可以渲染 HTML 标签 (strings) 或 React 组件 (classes)。</p>
<p>要渲染 HTML 标签，只需在 JSX 里使用小写字母的标签名。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myDivElement = <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"foo"</span> /&gt;</span>;</span></div><div class="line">ReactDOM.render(myDivElement, document.getElementById('example'));</div></pre></td></tr></table></figure>
<p>要渲染 React 组件，只需创建一个大写字母开头的本地变量。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MyComponent = React.createClass(&#123;<span class="comment">/*...*/</span>&#125;);</div><div class="line"><span class="keyword">var</span> myElement = <span class="xml"><span class="tag">&lt; <span class="attr">MyComponent</span> <span class="attr">someProperty</span>=<span class="string">&#123;true&#125;</span> /&gt;</span>;</span></div><div class="line">ReactDOM.render(myElement, document.getElementById('example'));</div></pre></td></tr></table></figure>
<p>React 的 JSX 使用大、小写的约定来区分本地组件的类和 HTML 标签。</p>
<p>注意，</p>
<ul>
<li>原生 HTML 元素名以小写字母开头，而自定义的 React 类名以大写字母开头，比如 HelloMessage 不能写成 helloMessage。除此之外还需要注意组件类只能包含一个顶层标签，否则也会报错。</li>
<li>在定义一个组件的时候,output的所有的标签必须被正确的闭合，这样子react框架才能正确识别每个标签</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">render()&#123;</div><div class="line">return (</div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span> = <span class="string">&#123;this.handleSubmit&#125;</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span>&gt;</span>name</div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span> = <span class="string">&#123;this.state.value&#125;</span> <span class="attr">onChange</span> = <span class="string">&#123;this.handleChange&#125;/</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>  <span class="attr">value</span>=<span class="string">"submit"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line">)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>注意每一个input标签里面的 最后的  /  不能缺少</strong></p>
<p><strong>Components must return a single root element.</strong> </p>
<h3 id="2-react-元素的不可变性"><a href="#2-react-元素的不可变性" class="headerlink" title="2 react 元素的不可变性"></a>2 react 元素的不可变性</h3><p>2.1 React Only Updates What’s Necessary</p>
<p>React DOM compares the element and its children to the previous one, and only applies the DOM updates necessary to bring the DOM to the desired state.</p>
<h3 id="3-react组件"><a href="#3-react组件" class="headerlink" title="3 react组件"></a>3 react组件</h3><ul>
<li>组件是React中构建用户界面的基本单位。它们和外界的交互除了状态（state）之外，还有就是属性（props）。事实上，状态更多的是一个组件内部去自己维护，而属性则由外部在初始化这个组件时传递进来（一般是组件需要管理的数据）。React认为属性应该是只读的，一旦赋值过去后就不应该变化。</li>
<li>每个组件只需要前端开发者提供一个 render 函数，把 props 和 state 映射成网页元素。</li>
<li>setState : 组件规范中定义了setState方法，每次调用时都会更新组件的状态，触发render方法。需要注意，render方法是被异步调用的，这可以保证同步的多个setState方法只会触发一次render，有利于提高性能。和props不同，state是组件的内部状态，除了初始化时可能由props来决定，之后就完全由组件自身去维护。在组件的整个生命周期中，React强烈不推荐去修改自身的props，因为这会破坏UI和Model的一致性，props只能够由使用者来决定。</li>
<li>props :  组件自身定义了一组props作为对外接口，展示一个组件时只需要指定props作为XML节点的属性。组件很少需要对外公开方法，唯一的交互途径就是props。这使得使用组件就像使用函数一样简单，给定一个输入，组件给定一个界面输出。</li>
<li>this.props.children :  <code>this.props.children</code> 的值有三种可能：如果当前组件没有子节点，它就是 <code>undefined</code> ;如果有一个子节点，数据类型是 <code>object</code> ；如果有多个子节点，数据类型就是 <code>array</code> 。所以，处理 <code>this.props.children</code> 的时候要小心。</li>
</ul>
<p>声明组件有两种方式，一种是直接函数function声明 一种是直接class类声明</p>
<p>Components let you split the UI into independent, reusable pieces, and think about each piece in isolation.</p>
<p>Conceptually, components are like JavaScript functions. They accept arbitrary inputs (called “props”) and return React elements describing what should appear on the screen.</p>
<p>函数声明组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">     <span class="function"><span class="keyword">function</span> <span class="title">Welcome</span>(<span class="params">props</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></div><div class="line">     &#125;</div><div class="line">   <span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">Welcome</span> <span class="attr">name</span> = <span class="string">"Jhon"</span>/&gt;</span></span></div><div class="line">   ReactDOM.render(</div><div class="line">       element,</div><div class="line">       document.getElementById('root')</div><div class="line"></div><div class="line">   )</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>类声明组件 super调用了父类的constructor创造了父类的实例对象this，然后用子类的构造函数进行修改</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">     <span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">         render()&#123;</div><div class="line">             <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></div><div class="line">         &#125;</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     <span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">Welcome</span> <span class="attr">name</span> = <span class="string">'Jhon'</span>/&gt;</span></span></div><div class="line">     ReactDOM.render(</div><div class="line">         element,</div><div class="line">         document.getElementById('root')</div><div class="line">     )</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>当我们使用组件<code>&lt;Welcome /&gt;</code>时，其实是对Main类的实例化——new Welcome，只不过react对这个过程进行了封装，让它看起来更像是一个标签。类和模块内部默认使用严格模式，所以不需要用use strict指定运行模式。</p>
<p><code>React.Component</code> is an abstract base class, so it rarely makes sense to refer to <code>React.Component</code> directly. Instead, you will typically subclass it, and define at least a <a href="https://facebook.github.io/react/docs/react-component.html#render" target="_blank" rel="external"><code>render()</code></a> method.</p>
<p>组件的 </p>
<p>Let’s recap what happens in this example:</p>
<ol>
<li>We call <code>ReactDOM.render()</code> with the <code>&lt;Welcome name=&quot;Jhon&quot; /&gt;</code> element.</li>
<li>React calls the <code>Welcome</code> component with <code>{name: &#39;Jhon&#39;}</code> as the props.</li>
<li>Our <code>Welcome</code> component returns a <code>&lt;h1&gt;Hello, Jhon&lt;/h1&gt;</code> element as the result.</li>
<li>React DOM efficiently updates the DOM to match <code>&lt;h1&gt;Hello,Jhon&lt;/h1&gt;</code>.</li>
</ol>
<p>我们可以通过 this.props对象向组件传递参数</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">      <span class="keyword">var</span> HelloWorld = React.createClass(&#123;</div><div class="line">        <span class="attr">render</span> : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello &#123;this.props.name1&#125;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello &#123;this.props.name2&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span>          </div><div class="line">                <span class="tag">&lt;/<span class="name">h1</span>&gt;</span>        </div><div class="line">        &#125;</div><div class="line">      &#125;) </div><div class="line">   ReactDOM.render(</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">name1</span> = <span class="string">'Jhon'</span> <span class="attr">name2</span> = <span class="string">"JiM"</span>/&gt;</span>,</span></div><div class="line">      document.getElementById('root')</div><div class="line">   )   </div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>复合组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">   </div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Welcome</span>(<span class="params">props</span>)</span>&#123;</div><div class="line">       <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>)</span>&#123;</div><div class="line">       <span class="keyword">return</span> (</div><div class="line">           &lt;div&gt;</div><div class="line">               &lt;Welcome name = 'Jhon'/&gt;</div><div class="line">                &lt;Welcome name = 'JiM'/&gt;</div><div class="line">                 &lt;Welcome name = 'Kobe'/&gt;</div><div class="line">           &lt;/div&gt;</div><div class="line">       )</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   const element = &lt;App /&gt;</div><div class="line"></div><div class="line">   ReactDOM.render(</div><div class="line">       element ,</div><div class="line">       document.getElementById('root')</div><div class="line">   )</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>注意组件实例化的时候传入的属性是js表达式的时候，要用<code>{}</code> 括起来 </strong>, javascritpExpression必须要用<code>{ }</code> 括起来</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    </div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="xml"></span></div><div class="line">   function formateDate(date)&#123;</div><div class="line">        return date.toLocaleDateString();</div><div class="line">   &#125;</div><div class="line">   function Comment(props)&#123;</div><div class="line">       console.log(props)</div><div class="line">       return (</div><div class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">"Comment"</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'UserInfo'</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">img</span> <span class="attr">className</span> = <span class="string">'avatar'</span> <span class="attr">src</span>=<span class="string">&#123;props.author.avatarUrl&#125;</span> <span class="attr">alt</span>=<span class="string">&#123;props.author.name&#125;/</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'UserInfo-name'</span>&gt;</span></div><div class="line">                       &#123;props.author.name&#125;</div><div class="line">                   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'Comment-text'</span>&gt;</span></div><div class="line">                   &#123;props.text&#125;</div><div class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'Comment-data'</span>&gt;</span></div><div class="line">                   &#123;formateDate(props.date)&#125;</div><div class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">       );</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   const comment = &#123;</div><div class="line">       date : new Date(),</div><div class="line">       text : 'Thank you for give me the chance',</div><div class="line">       author : &#123;</div><div class="line">           name : 'Jhon',</div><div class="line">           avatarUrl : 'http://placekitten.com/g/64/64'</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line"> </div><div class="line"></div><div class="line"> const element = <span class="tag">&lt;<span class="name">Comment</span> <span class="attr">author</span> = <span class="string">&#123;comment.author&#125;</span> <span class="attr">text</span> = <span class="string">&#123;comment.text&#125;</span> <span class="attr">date</span> = <span class="string">&#123;comment.date&#125;</span> /&gt;</span></div><div class="line">  ReactDOM.render(</div><div class="line">    element,</div><div class="line">    document.getElementById('root')</div><div class="line">  )</div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>对于组合组件要进行抽取出来，即使功能在小，要充分利用react的组件化思想,以上代码通过组件化思想进行抽取之后</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="xml"></span></div><div class="line">  function formateDate(date)&#123;</div><div class="line">       return date.toLocaleDateString();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function UserInfo(props)&#123;</div><div class="line">      return (</div><div class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'UserInfo'</span>&gt;</span></div><div class="line">              <span class="tag">&lt;<span class="name">img</span> <span class="attr">calssName</span> = <span class="string">'avatar'</span> <span class="attr">src</span> = <span class="string">&#123;props.author.avatarUrl&#125;</span> <span class="attr">alt</span> = <span class="string">&#123;props.author.name&#125;/</span>&gt;</span></div><div class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'UserInfo-name'</span>&gt;</span></div><div class="line">                  &#123;props.author.name&#125;</div><div class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      )</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function CommentText(props)&#123;</div><div class="line">      return (</div><div class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'Comment-text'</span>&gt;</span></div><div class="line">                  &#123;props.text&#125;</div><div class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      )</div><div class="line">           </div><div class="line">      </div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function CommentData (props)&#123;</div><div class="line">      return (</div><div class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">'Comment-data'</span>&gt;</span></div><div class="line">                  &#123;formateDate(props.date)&#125;</div><div class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      )</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  function Comment(props)&#123;</div><div class="line">      console.log(props)</div><div class="line">      return (</div><div class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span> = <span class="string">"Comment"</span>&gt;</span></div><div class="line">              <span class="tag">&lt;<span class="name">UserInfo</span> <span class="attr">author</span> =  <span class="string">&#123;props.author&#125;</span> /&gt;</span></div><div class="line">              <span class="tag">&lt;<span class="name">CommentText</span> <span class="attr">text</span> = <span class="string">&#123;props.text&#125;/</span>&gt;</span></div><div class="line">              <span class="tag">&lt;<span class="name">CommentData</span> <span class="attr">date</span> = <span class="string">&#123;props.date&#125;/</span>&gt;</span>   </div><div class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      );</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  const comment = &#123;</div><div class="line">      date : new Date(),</div><div class="line">      text : 'Thank you for give me the chance',</div><div class="line">      author : &#123;</div><div class="line">          name : 'Jhon',</div><div class="line">          avatarUrl : 'http://placekitten.com/g/64/64'</div><div class="line">      &#125;</div><div class="line">  &#125;</div><div class="line">const element = <span class="tag">&lt;<span class="name">Comment</span> <span class="attr">author</span> = <span class="string">&#123;comment.author&#125;</span> <span class="attr">text</span> = <span class="string">&#123;comment.text&#125;</span> <span class="attr">date</span> = <span class="string">&#123;comment.date&#125;</span> /&gt;</span></div><div class="line"> ReactDOM.render(</div><div class="line">   element,</div><div class="line">   document.getElementById('root')</div><div class="line"> )</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    </div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="xml"></span></div><div class="line">     var WebSite = React.createClass(&#123;</div><div class="line">         render : function()&#123;</div><div class="line">             return (</div><div class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">Name</span> <span class="attr">name</span> = <span class="string">&#123;this.props.name&#125;/</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">Link</span> <span class="attr">link</span> = <span class="string">&#123;this.props.link&#125;/</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">             );</div><div class="line">         &#125;</div><div class="line">     &#125;)</div><div class="line">   </div><div class="line">   var Name = React.createClass(&#123;</div><div class="line">       render : function()&#123;</div><div class="line">           return (</div><div class="line">               <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">           );</div><div class="line">       &#125;</div><div class="line">   &#125;)</div><div class="line"></div><div class="line">   var Link = React.createClass(&#123;</div><div class="line">       render : function()&#123;</div><div class="line">           return (</div><div class="line">               <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">&#123;this.props.link&#125;</span>&gt;</span> &#123;this.props.link&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">           );</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">)</div><div class="line"></div><div class="line">   ReactDOM.render(</div><div class="line">       <span class="tag">&lt;<span class="name">WebSite</span> <span class="attr">name</span> = <span class="string">'Jhon'</span> <span class="attr">link</span> = <span class="string">'www.baidu.com'</span>/&gt;</span>,</div><div class="line">       document.getElementById('root')</div><div class="line">   )</div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="4-组件的属性"><a href="#4-组件的属性" class="headerlink" title="4 组件的属性"></a>4 组件的属性</h3><p>我们声明一个组件，然后看下组件到底是什么</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ListItem</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">        render()&#123;</div><div class="line">            <span class="keyword">return</span> (</div><div class="line">                <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">            )</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">      </div><div class="line">      <span class="keyword">var</span> element = <span class="xml"><span class="tag">&lt;<span class="name">ListItem</span> <span class="attr">name</span> = <span class="string">'Jhon'</span>/&gt;</span> ;</span></div><div class="line">       console.log(element);</div><div class="line">       ReactDOM.render(</div><div class="line">           element,</div><div class="line">           document.getElementById('root')</div><div class="line">       )</div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>控制台输出如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Object &#123;$$typeof: Symbol(react.element), key: null, ref: null, props: Object, type: function…&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">   </div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">       <span class="keyword">constructor</span>(props) &#123;</div><div class="line">           <span class="keyword">super</span>(props);</div><div class="line">           <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">       &#125;</div><div class="line"></div><div class="line"></div><div class="line">       render()&#123;</div><div class="line">           <span class="keyword">return</span> (</div><div class="line">               <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">                   <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">                  </div><div class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">           );</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">  </div><div class="line">   </div><div class="line">   ReactDOM.render(</div><div class="line">       <span class="xml"><span class="tag">&lt;<span class="name">Clock</span> /&gt;</span>,</span></div><div class="line">       document.getElementById('root')</div><div class="line">   )</div><div class="line">   </div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>console.log(this)输出如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Clock &#123;props: Object, context: undefined, refs: Object, updater: Object&#125;</div></pre></td></tr></table></figure>
<p>console.log(<code>&lt;Clock /&gt;</code>) 输出如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Object &#123;$$typeof: Symbol(react.element), key: null, ref: null, props: Object, type: function…&#125;</div></pre></td></tr></table></figure>
<p>刚开始学习React,总是有点模糊 props和state的区别，可以看出在打印this的时候，props就是存在的，而state需要定义之后才会显示</p>
<p>改变constructor函数，可以看出输出了state对象</p>
<p><strong>state必须被设置为一个对象，否则React编译会报错，大家可以自行尝试下</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">constructor(props) &#123;</div><div class="line">            super(props);</div><div class="line">            this.state = &#123;color : &apos;red&apos;&#125;</div><div class="line">            console.log(this);</div><div class="line">            console.log(this.setState);</div><div class="line">            console.log(this.props);</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Clock &#123;props: Object, context: undefined, refs: Object, updater: Object, state: Object&#125;</div></pre></td></tr></table></figure>
<p>以上consturctor函数中，我们也打印了  console.log(this.setState);  其实在React源码中，setState是存在于 React.Component上的原型上的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ReactComponent.prototype.setState = function (partialState, callback) &#123; sonmeCode &#125; ;</div></pre></td></tr></table></figure>
<h3 id="5-组件的render函数"><a href="#5-组件的render函数" class="headerlink" title="5 组件的render函数"></a>5 组件的render函数</h3><p>The <code>render()</code> method is required.</p>
<p>When called, it should examine <code>this.props</code> and <code>this.state</code> and return a single React element. This element can be either a representation of a native DOM component, such as <code>&lt;div /&gt;</code>, or another composite component that you’ve defined yourself.</p>
<p>You can also return <code>null</code> or <code>false</code> to indicate that you don’t want anything rendered. When returning <code>null</code> or <code>false</code>, <code>ReactDOM.findDOMNode(this)</code> will return <code>null</code>.</p>
<p>The <code>render()</code> function should be pure, meaning that it does not modify component state, it returns the same result each time it’s invoked, and it does not directly interact with the browser. If you need to interact with the browser, perform your work in <code>componentDidMount()</code>or the other lifecycle methods instead. Keeping <code>render()</code> pure makes components easier to think about.</p>
<p>需要注意的是:</p>
<p><code>render()</code> will not be invoked if <a href="https://facebook.github.io/react/docs/react-component.html#shouldcomponentupdate" target="_blank" rel="external"><code>shouldComponentUpdate()</code></a> returns false.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/18/182jsx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/18/182jsx/" itemprop="url">
                  jsx基础
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-18T12:36:00+08:00">
                2017-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react/" itemprop="url" rel="index">
                    <span itemprop="name">react</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-初识jsx"><a href="#1-初识jsx" class="headerlink" title="1 初识jsx"></a>1 初识jsx</h3><p>React 使用 JSX 来替代常规的 JavaScript。</p>
<p>JSX 是一个看起来很像 XML 的 JavaScript 语法扩展。</p>
<p>我们不需要一定使用 JSX，但它有以下优点：</p>
<ul>
<li>JSX 执行更快，因为它在编译为 JavaScript 代码后进行了优化。</li>
<li>它是类型安全的，在编译过程中就能发现错误。</li>
<li><p>使用 JSX 编写模板更加简单快速。</p>
<p>JSX 的基本语法规则：遇到 HTML 标签（以 <code>&lt;</code> 开头），就用 HTML 规则解析；遇到代码块（以 <code>{</code> 开头），就用 JavaScript 规则解析。上面代码的运行结果如下。</p>
</li>
</ul>
<p>JSX语法，像是在Javascript代码里直接写XML的语法，实质上这只是一个语法糖，每一个XML标签都会被JSX转换工具转换成纯Javascript代码，React 官方推荐使用JSX， 当然你想直接使用纯Javascript代码写也是可以的，只是使用JSX，组件的结构和组件之间的关系看上去更加清晰。</p>
<p>JSX是一种语法糖，关于如何编译JSX代码可以参见如下链接</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person = &lt;Person name=&#123;window.isLoggedIn ? window.name : ''&#125; /&gt;;</div></pre></td></tr></table></figure>
<p>上述代码经过JSX编译后会得到：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person = React.createElement(</div><div class="line">  Person,</div><div class="line">  &#123;<span class="attr">name</span>: <span class="built_in">window</span>.isLoggedIn ? <span class="built_in">window</span>.name : <span class="string">''</span>&#125;</div><div class="line">);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;MyButton color=&quot;blue&quot; shadowSize=&#123;2&#125;&gt;</div><div class="line">  Click Me</div><div class="line">&lt;/MyButton&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">React.createElement(</div><div class="line">  MyButton,</div><div class="line">  &#123;color: &apos;blue&apos;, shadowSize: 2&#125;,</div><div class="line">  &apos;Click Me&apos;</div><div class="line">)</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">//使用JSX</div><div class="line">React.render(</div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>,</div><div class="line">    document.getElementById('example')</div><div class="line">);</div><div class="line"> </div><div class="line">//不使用JSX</div><div class="line">React.render(</div><div class="line">    React.createElement('div', null,</div><div class="line">        React.createElement('div', null,</div><div class="line">            React.createElement('div', null, 'content')</div><div class="line">        )</div><div class="line">    ),</div><div class="line">    document.getElementById('example')</div><div class="line">);</div></pre></td></tr></table></figure>
<ul>
<li>r如果标签是以小写字母开头，那么React会寻找内置标签，比如div  sapn等</li>
<li>如果标签是以大写字母开头，React会调用React.createElement去编译这个标签</li>
</ul>
<h3 id="2-我们可以在JSX中"><a href="#2-我们可以在JSX中" class="headerlink" title="2 我们可以在JSX中"></a>2 我们可以在JSX中</h3><ul>
<li>插入任何js表达式</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">function getGreeting(user) &#123;</div><div class="line">  if (user) &#123;</div><div class="line">    return <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;formatName(user)&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>;</div><div class="line">  &#125;</div><div class="line">  return <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, Stranger.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">    ReactDOM.render(</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span> &gt;</span>&#123;1+3&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">    ,</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</div><div class="line">  )</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>props如果没有提供值，那么默认值是true,以下声明是等价的</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;MyTextBox autocomplete /&gt;</div><div class="line"></div><div class="line">&lt;MyTextBox autocomplete=&#123;true&#125; /&gt;</div></pre></td></tr></table></figure>
<ul>
<li>props声明可以是字符串类型以及js表达式 <code>{}</code> 包括的代码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;MyComponent message=&quot;hello world&quot; /&gt;</div><div class="line"></div><div class="line">&lt;MyComponent message=&#123;&apos;hello world&apos;&#125; /&gt;</div></pre></td></tr></table></figure>
<ul>
<li>指明类</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> element1 = <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">'hello'</span>&gt;</span>hello1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line"><span class="comment">//等价于以下</span></div><div class="line"><span class="keyword">const</span> element2 = React.createElement(</div><div class="line">  <span class="string">'div'</span>,</div><div class="line">  &#123;<span class="attr">className</span>:<span class="string">'sayHello2'</span>&#125;,</div><div class="line">  <span class="string">'hello2'</span> </div><div class="line">)</div><div class="line"><span class="comment">//内部大概的解析过程</span></div><div class="line"><span class="comment">// Note: this structure is simplified</span></div><div class="line"><span class="keyword">const</span> element = &#123;</div><div class="line">  <span class="attr">type</span>: <span class="string">'h1'</span>,</div><div class="line">  <span class="attr">props</span>: &#123;</div><div class="line">    <span class="attr">className</span>: <span class="string">'greeting'</span>,</div><div class="line">    <span class="attr">children</span>: <span class="string">'Hello, world'</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>完整代码如下</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">        <span class="keyword">const</span> user = &#123;</div><div class="line">            <span class="attr">firstName</span>:<span class="string">'Jhon'</span>,</div><div class="line">            <span class="attr">lastName</span>:<span class="string">'Kobe'</span></div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">formatName</span>(<span class="params">user</span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span>(user)&#123;</div><div class="line">                <span class="keyword">return</span> user.firstName + <span class="string">" "</span> + user.lastName ;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="string">'stranger hello '</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">const</span> element1 = <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">'hello'</span>&gt;</span>hello1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">        <span class="keyword">const</span> element2 = React.createElement(</div><div class="line">            <span class="string">'div'</span>,</div><div class="line">            &#123;<span class="attr">className</span>:<span class="string">'sayHello2'</span>&#125;,</div><div class="line">            <span class="string">'hello2'</span> </div><div class="line">        )</div><div class="line"></div><div class="line">        ReactDOM.render(</div><div class="line">            element1,</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">'root1'</span>)</div><div class="line">        )</div><div class="line"></div><div class="line">        ReactDOM.render(</div><div class="line">            element2,</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">'root2'</span>)</div><div class="line">        )</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>注意render函数中只能有一个顶层标签</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="javascript"></span></div><div class="line">        ReactDOM.render(</div><div class="line">           <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-attr</span> = <span class="string">'name'</span>&gt;</span>this is a test</span></div><div class="line">               <span class="tag">&lt;<span class="name">h2</span>&gt;</span>this is a test 2 <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  		<span class="tag">&lt;/<span class="name">div</span>&gt;</span>,</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</div><div class="line">        )</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>以下是错误写法,顶层标签只能含有一个。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="xml">        </span></div><div class="line">        ReactDOM.render(</div><div class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-attr</span> = <span class="string">'name'</span>&gt;</span>this is a test<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">           <span class="tag">&lt;<span class="name">h2</span>&gt;</span>this is a test 2 <span class="tag">&lt;/<span class="name">h2</span>&gt;</span>,</div><div class="line">            document.getElementById('root')</div><div class="line">        )   </div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/babel'</span>&gt;</span><span class="xml"></span></div><div class="line">      var HelloWorld = React.createClass(&#123;</div><div class="line">        render : function()&#123;</div><div class="line">          return <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello &#123;this.props.name1&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello &#123;this.props.name2&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">        &#125;</div><div class="line">      &#125;) </div><div class="line">   </div><div class="line">   <span class="tag">&lt;<span class="name">HelloWorld</span> <span class="attr">name1</span> = <span class="string">'Jhon'</span> <span class="attr">name2</span> = <span class="string">"JiM"</span>/&gt;</span></div><div class="line">       //这样也无法渲染出来</div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>可以使用三元运算符，但是不能使用if-else表达式</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">const i = 1 ;</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  <span class="tag">&lt;<span class="name">div</span> &gt;</span>&#123;</div><div class="line">    i == 1 ? ' 2' : '3' </div><div class="line">  &#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  ,</div><div class="line">  document.getElementById('root')</div><div class="line">)</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/13/180面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/13/180面试题/" itemprop="url">
                  面试题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-13T12:36:00+08:00">
                2017-04-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/forwork/" itemprop="url" rel="index">
                    <span itemprop="name">forwork</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>总结一些平时在电脑上写的很溜，但是在面试白班测试总是写不好的一些面试题吧!个人不喜欢白板测试，没有那种敲代码的感觉，并且一些细节也不好把控。</p>
<p>1 编写函数sum(2,3)和sum(2)(3)都能得到5</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     <span class="keyword">var</span> cache = <span class="built_in">arguments</span>[<span class="number">0</span>];</div><div class="line">     <span class="keyword">if</span>(!<span class="built_in">arguments</span>)&#123;</div><div class="line">         <span class="keyword">return</span> ;</div><div class="line">     &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">arguments</span>.length === <span class="number">1</span>)&#123;</div><div class="line">         <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">             <span class="keyword">return</span> cache+num</div><div class="line">         &#125;;</div><div class="line">     &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">arguments</span>.length === <span class="number">2</span> )&#123;</div><div class="line">         <span class="keyword">return</span> <span class="built_in">arguments</span>[<span class="number">0</span>]+<span class="built_in">arguments</span>[<span class="number">1</span>];</div><div class="line">     &#125;</div><div class="line"> &#125;</div><div class="line"></div><div class="line"> <span class="built_in">console</span>.log(sum(<span class="number">2</span>,<span class="number">3</span>));</div><div class="line"> <span class="built_in">console</span>.log(sum(<span class="number">2</span>)(<span class="number">3</span>));</div></pre></td></tr></table></figure>
<p>2 url地址的操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url =<span class="string">' http://item.taobao.com/item.htm?a=1&amp;b=2&amp;c=&amp;d=xxx&amp;e'</span>;</div><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">getJson</span> (<span class="params">url</span>)</span>&#123;</div><div class="line">       <span class="keyword">var</span> flag = url.indexOf(<span class="string">'?'</span>)+<span class="number">1</span>;</div><div class="line">       <span class="built_in">console</span>.log(flag);</div><div class="line"></div><div class="line">       <span class="keyword">var</span> res = url.slice(flag);</div><div class="line">       <span class="built_in">console</span>.log(res);</div><div class="line"></div><div class="line">       <span class="keyword">var</span> arr = res.split(<span class="string">'&amp;'</span>);</div><div class="line">       <span class="keyword">var</span> Json = &#123;&#125;;</div><div class="line"></div><div class="line">       <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;arr.length ;i++)&#123;</div><div class="line">           <span class="keyword">var</span> temp = arr[i].split(<span class="string">'='</span>);</div><div class="line">           <span class="built_in">console</span>.log(temp);</div><div class="line">           <span class="built_in">console</span>.log(temp[<span class="number">0</span>]);</div><div class="line">           <span class="built_in">console</span>.log(temp[<span class="number">1</span>]);</div><div class="line">           Json[temp[<span class="number">0</span>]] = temp[<span class="number">1</span>];</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> Json ;</div><div class="line">   &#125;</div><div class="line">   getJson(url);</div><div class="line">   <span class="built_in">console</span>.log(getJson(url));</div></pre></td></tr></table></figure>
<p>3 运算符的操作，主要是 +    ++    -   &amp;&amp;   ||   以及运算符的优先级的问题(感兴趣可以看看我这篇总结)</p>
<p>这里在回顾一下</p>
<p>+  运算符    </p>
<ul>
<li>如果一个运算数是字符串，那么这个运算环境就是字符串环境，另外一个运算数，不论是布尔类型，数字类型，undefined  null NaN 以及数组，对象都会转化为字符串，然后进行字符串拼接</li>
<li>如果一个运算数是数字，另外一个运算数是布尔类型，会将布尔类型转化为数字</li>
<li>如果一个运算数是数组或者对象，会将数组或者对象转化为原始数据类型(调用toString方法)，然后进行运算(一般也就是将数组或者对象转化为字符串，所以后续也是进行的字符串的拼接)</li>
</ul>
<p>-  运算符</p>
<ul>
<li>-运算符提供的是一个数字运行环境，会将字符串，布尔类型的值转化为数字(Number和parseInt方法)，如果转化失败则返回NaN</li>
<li>如果有运算数是对象或者数组，会先调用对象或者数组的toString方法，然后调用Number和parseInt方法转化为数字，进行数字的运算，如果转化失败则返回NaN</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="literal">true</span> + <span class="literal">false</span>);<span class="comment">//1</span></div><div class="line"><span class="built_in">console</span>.log(&#123;&#125;+<span class="literal">true</span>);<span class="comment">//[object Object]true</span></div><div class="line"><span class="built_in">console</span>.log([]+<span class="literal">true</span>);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="literal">true</span> + []);<span class="comment">//true</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">1</span> + [] + <span class="number">1</span> );<span class="comment">//11</span></div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(<span class="number">1</span> + []));<span class="comment">//string</span></div><div class="line"><span class="built_in">console</span>.log([].valueOf());<span class="comment">//[]</span></div><div class="line"><span class="built_in">console</span>.log([] - <span class="literal">true</span>);<span class="comment">//-1</span></div><div class="line"><span class="built_in">console</span>.log(&#123;&#125; - <span class="literal">true</span>);<span class="comment">//NaN</span></div><div class="line"><span class="built_in">console</span>.log(<span class="number">1</span> - [] - <span class="number">1</span> );<span class="comment">//0</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'2'</span> - <span class="literal">false</span>);<span class="comment">//2</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"2"</span> - <span class="literal">undefined</span>);<span class="comment">//NaN</span></div></pre></td></tr></table></figure>
<p>4 有关闭包的一个测试  如何实现点击每个 li 输出其 index 值，注册事件之后，触发事件，然后事件监听器函数就会执行</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span> = <span class="string">'test'</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>ee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>ee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>ee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> liObj = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>).children;</div><div class="line"><span class="built_in">console</span>.log(liObj);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; liObj.length ; i++)&#123;</div><div class="line">  liObj[i].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(i);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//这个是不行的   注册事件之后，当点击的时候，i的值已经是 3 的，所以每次输出都是3</span></div></pre></td></tr></table></figure>
<p>利用闭包  返回一个函数作为listener</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; liObj.length ; i++)&#123;</div><div class="line">  liObj[i].onclick = (<span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(n);</div><div class="line">    &#125;</div><div class="line">  &#125;)(i+<span class="number">1</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>还有一个简单的实现思路就是  给每一个li设置一个属性即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; liObj.length ; i++)&#123;</div><div class="line">  liObj[i].setAttribute(<span class="string">'index'</span>,i+<span class="number">1</span>);</div><div class="line">  liObj[i].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.getAttribute(<span class="string">'index'</span>));</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>5 类数组转化为数组  apply，call 第一个参数改变函数的this指向,第二个参数表示传入函数的参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arrayLike = &#123;</div><div class="line">  <span class="number">0</span> : <span class="string">"hai"</span>,</div><div class="line">  <span class="number">1</span> : <span class="string">"Jhon"</span>,</div><div class="line">  <span class="number">2</span> : <span class="string">"nam"</span>,</div><div class="line">  <span class="attr">length</span> : <span class="number">3</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> ret = <span class="built_in">Array</span>.prototype.slice.call(arrayLike,<span class="number">0</span>);</div><div class="line"><span class="built_in">console</span>.log(ret);</div></pre></td></tr></table></figure>
<p>6 数组的去重</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">9</span>];</div><div class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> arr = [<span class="keyword">this</span>[<span class="number">0</span>]];</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="keyword">this</span>.length ; i++)&#123;</div><div class="line">    <span class="comment">//如果新数组中没有当前比较项，则将当前比较项加入新数组</span></div><div class="line">    <span class="keyword">var</span> flag = <span class="literal">true</span> ;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span> ; j &lt; arr.length ; j++)&#123;</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">this</span>[i] === arr[j])&#123;</div><div class="line">        flag = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">break</span> ;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(flag == <span class="literal">true</span>)&#123;</div><div class="line">      arr.push(<span class="keyword">this</span>[i]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> arr ;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(arr.unique());</div></pre></td></tr></table></figure>
<p>7 字符串的去重</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> arr = [<span class="keyword">this</span>[<span class="number">0</span>]];</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="keyword">this</span>.length ; i++)&#123;</div><div class="line">    <span class="comment">//如果新数组中没有当前比较项，则将当前比较项加入新数组</span></div><div class="line">    <span class="keyword">var</span> flag = <span class="literal">true</span> ;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span> ; j &lt; arr.length ; j++)&#123;</div><div class="line">      <span class="keyword">if</span>(<span class="keyword">this</span>[i] === arr[j])&#123;</div><div class="line">        flag = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">break</span> ;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(flag == <span class="literal">true</span>)&#123;</div><div class="line">      arr.push(<span class="keyword">this</span>[i]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> arr ;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> str = <span class="string">'aaasdafafaasdddfggh'</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">detRep</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> arr = str.split(<span class="string">''</span>);</div><div class="line">  <span class="keyword">var</span> newArr = arr.unique();</div><div class="line">  <span class="keyword">var</span> newStr = newArr.join(<span class="string">''</span>);</div><div class="line">  <span class="keyword">return</span> newStr ;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(detRep(str));</div></pre></td></tr></table></figure>
<p>8 break和continue</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//break会直接跳出循环</span></div><div class="line"><span class="keyword">var</span> iNum = <span class="number">0</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;<span class="number">10</span>; i++) &#123;</div><div class="line">  <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">  iNum++;</div><div class="line">&#125;</div><div class="line">alert(iNum);<span class="comment">//4</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//continue会退出当前这一次的循环，进行下一次循环，后面表达式都不会在执行</span></div><div class="line"><span class="keyword">var</span> iNum = <span class="number">0</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;<span class="number">10</span>; i++) &#123;</div><div class="line">  <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">continue</span>;</div><div class="line">  &#125;</div><div class="line">  iNum++;</div><div class="line">&#125;</div><div class="line">alert(iNum);<span class="comment">//8</span></div></pre></td></tr></table></figure>
<p>9 + - 运算符以及NaN  undefined </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a;<span class="comment">//undefined </span></div><div class="line"><span class="keyword">var</span> b = a * <span class="number">0</span>;<span class="comment">//NaN</span></div><div class="line"><span class="built_in">console</span>.log(b * <span class="number">2</span> + <span class="string">"2"</span> - <span class="number">0</span> + <span class="number">4</span>);</div><div class="line"><span class="keyword">if</span> (b == b) &#123; <span class="comment">//false</span></div><div class="line">    <span class="built_in">console</span>.log(b * <span class="number">2</span> + <span class="string">"2"</span> - <span class="number">0</span> + <span class="number">4</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(!b * <span class="number">2</span> + <span class="string">"2"</span> - <span class="number">0</span> + <span class="number">4</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">//输出26</span></div></pre></td></tr></table></figure>
<p>主要考察以下知识点</p>
<ul>
<li>带有undefined的基本运算结果返回NaN ：  undefined*2   undefined+2等  </li>
<li>带有NaN的比较运算符结果返回false; NaN == NaN  也是false</li>
<li>x 和+ 运算中数字和布尔类型的运算，会将布尔类型转化为数字在进行运算  !b*2 = 2 </li>
<li>带有字符串的 +  性环境中，会将另外一个运算数转化为字符串，然后进行字符串的拼接 !b*2+’2’ : ‘22’;</li>
<li>- 性环境中，会将字符串，如果一个是字符串，另外一个是数字会将字符串转化为数字(即使两个都是字符串也会将两个都转化为字符串)  ‘22’-0  : 22  数字类型的22</li>
<li>如果没有 - 0 这步运算，那么返回的结果将是 字符串  ‘224’;</li>
</ul>
<p>10 日期操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//假设今天是  2017-4-12</span></div><div class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="built_in">console</span>.log(date.getFullYear());<span class="comment">//2017</span></div><div class="line"><span class="built_in">console</span>.log(date.getMonth());<span class="comment">//3  注意Month获取的月份是从0开始的</span></div><div class="line"><span class="built_in">console</span>.log(date.getDate());<span class="comment">//12</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> year = date.getFullYear();</div><div class="line"><span class="keyword">var</span> Month = date.getMonth()+<span class="number">1</span> ;</div><div class="line"><span class="keyword">var</span> day = date.getDate();</div><div class="line"></div><div class="line">Month = Month &lt; <span class="number">10</span> ? <span class="string">'0'</span>+Month : Month ;</div><div class="line">day = day &lt; <span class="number">10</span> ? <span class="string">'0'</span>+day : day ;</div><div class="line"><span class="keyword">var</span> res = year + <span class="string">'-'</span>+ Month + <span class="string">'-'</span>+day;</div><div class="line"><span class="built_in">console</span>.log(res);</div></pre></td></tr></table></figure>
<p>11 实时获取页面中的元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="keyword">var</span> items = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>);</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; items.length; i++)&#123;</div><div class="line">    <span class="keyword">if</span>(items[i].innerHTML == <span class="string">'1'</span>)&#123;</div><div class="line">      <span class="built_in">console</span>.log(i);</div><div class="line">      items[i].parentNode.removeChild(items[i]);</div><div class="line">      <span class="built_in">console</span>.dir(items);<span class="comment">//items已经剩下四个了而此时的索引值并没有改变</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>执行后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Item</div><div class="line">1</div><div class="line">Item</div><div class="line">Item</div></pre></td></tr></table></figure>
<p>这里需要注意的一点是 DOM获取的元素  items是实时更新的；</p>
<p>12 变量声明提升  函数声明优先于变量声明</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(a);<span class="comment">//是一个函数</span></div><div class="line"><span class="keyword">var</span> a = <span class="number">3</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"><span class="built_in">console</span>.log(a);<span class="comment">////3</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/25/live or life/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/25/live or life/" itemprop="url">
                  live for life ? or live to life
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-25T12:36:00+08:00">
                2017-03-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/随笔/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="life-or-live"><a href="#life-or-live" class="headerlink" title="life  or  live ?"></a>life  or  live ?</h2><p>1    有时候，为了生活或者更好的生活，为了父母可以有个安稳的、健康的晚年，为了未来的家庭可以安稳，自己总要去经历很多，孤军奋战，默默地去努力，去奋斗.</p>
<p>​    时光就是像沙漏，它溜走的速度超过你的想象，在北京漂泊总是回想过去的日子，有人陪你玩，有人陪你笑</p>
<p>​    很多人说，孤独吗？那就对了，孤独就是你成长的时候；</p>
<p>​    也有很多人说，能承受多大的委屈和孤独，就能撑起多大的梦想和责任；</p>
<p>其实我觉得，幸福感才是最重要的，一个人的幸福感来自于他对于生活节奏的把控，对于时间管理的合理化；如果感到了孤独，那就联络下朋友，新朋友，老朋友都可以；如果感到委屈了，那就去努力去忘掉那些委屈，没有谁的生活是不委屈的，没有背景，没有依赖，那就得靠自己；</p>
<p>2    很多人知道马云那句:梦想还是要有的，万一实现了呢？</p>
<p>我觉得 梦想可以有，</p>
<p>无论能不能实现，不放弃，不浮躁，埋下它的种子，</p>
<p>实现了则为它喝彩，</p>
<p>不实现，至少我们曾经为了它真正的战斗过；</p>
<p>坚持一下下，阳光总会来的；</p>
<p>3    毕业转眼两年了，对于市面上的各种鸡汤从来不感冒，一直觉得一个人的强大不在于外在的力量驱使，也不在于别人的鼓励和支持，一个人真正的强大来自于过去所有的时间的打磨和沉淀，或者说，一个人的不强大来自于过去所有的时间的打磨和沉淀；</p>
<p>愿我们每个正值青春奋斗的年纪的各位，走在路上，并且健康、积极的走在路上，成为自己想要成为的人，过自己想要的生活。</p>
<p>4    一个人要有自己的爱好，对于我来说，音乐和篮球是我爱好的主战场，有了它们，确实会让我感到平静许多；每次触摸到篮球，我就会感到充实和快乐；浮躁的时候听一些自己喜欢的音乐，会让自己安静下来。</p>
<p>有爱好的人是幸福的，它会让我们感到存在。</p>
<p>5    最近一段时间确实感到很累，记一笔吧。</p>
<p>​                                                                    2017.3.20   12:48</p>
<p>继续学习，一点点啃掉各个技术难点。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/17/168NodeJs中的path路径浅析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/17/168NodeJs中的path路径浅析/" itemprop="url">
                  NodeJs中的path路径浅析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-17T12:36:00+08:00">
                2017-01-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index">
                    <span itemprop="name">nodejs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-node-服务器端-文件路径的相关问题"><a href="#1-node-服务器端-文件路径的相关问题" class="headerlink" title="1  node 服务器端 文件路径的相关问题"></a>1  node 服务器端 文件路径的相关问题</h3><p>首先来看下基础概念</p>
<p>node提供了两个全局变量 _ <em>filename (表示当前文件的绝对根路径) 和 </em> _dirname  (表示当前文件所在目录的绝对根路径)</p>
<p>先来看下测试代码的目录结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">F : </div><div class="line">	-workspace </div><div class="line">    	-app</div><div class="line">    		-hero-admin</div><div class="line">    			-common.js</div><div class="line">    		-path</div><div class="line">    			-a.js</div></pre></td></tr></table></figure>
<p>common.js    </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'this is some data from hero-admin'</span>)</div></pre></td></tr></table></figure>
<p>a.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'path__dirname=='</span>+ __dirname);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'path.process=='</span> + __filename);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'process.cwd=='</span>+process.cwd());</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'path.resolve=='</span>+path.resolve(<span class="string">'./'</span>));</div></pre></td></tr></table></figure>
<p>第一种情况，在path目录下  执行命令    node a.js     在node 终端输出结果如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//path__dirname==F:\workspace\app\path</span></div><div class="line"><span class="comment">//path.process==F:\workspace\app\path\a.js</span></div><div class="line"><span class="comment">//process.cwd==F:\workspace\app\path</span></div><div class="line"><span class="comment">//path.resolve==F:\workspace\app\path</span></div></pre></td></tr></table></figure>
<p>第二种情况，在 app 目录下  执行命令   node  path/a.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//path__dirname==F:\workspace\app\path</span></div><div class="line"><span class="comment">//path.process==F:\workspace\app\path\a.js</span></div><div class="line"><span class="comment">//process.cwd==F:\workspace\app</span></div><div class="line"><span class="comment">//path.resolve==F:\workspace\app</span></div></pre></td></tr></table></figure>
<p><strong>通过上面的代码演示，我们可以发现，<em> </em> dirname 和  <em> </em> filename 的值是 和node命令执行的时候所在的目录没有关系的，无论我们在哪个目录执行  a.js   文件  <em> </em> dirnam 和 <em> </em> filename的值 永远都是返回  a.js 该文件所属目录的绝对路径(相对于根目录)</strong>，这个特性记住，下面会有应用。</p>
<h3 id="2-对于一般文件的引用的路径，会受到启动nodejs终端不同路径的影响"><a href="#2-对于一般文件的引用的路径，会受到启动nodejs终端不同路径的影响" class="headerlink" title="2 对于一般文件的引用的路径，会受到启动nodejs终端不同路径的影响"></a>2 对于一般文件的引用的路径，会受到启动nodejs终端不同路径的影响</h3><p>接下来我们改变下a.js文件的内容</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line">fs.readFile(<span class="string">'../hero-admin/common.js'</span>,<span class="string">'utf-8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err);</div><div class="line">    <span class="built_in">console</span>.log(data);</div><div class="line"></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>2.1 此时我们在path目录下运行  node a.js</p>
<p>可以得到common.js里面的内容 </p>
<p>2.2 如果我们改在 app  目录下运行   node path/a.js</p>
<p>此时会抛出错误，找不到文件路径</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123; <span class="attr">Error</span>: ENOENT: no such file or directory, open <span class="string">'F:\workspace\hero-admin\common.js'</span></div><div class="line">    at <span class="built_in">Error</span> (native)</div><div class="line">  errno: <span class="number">-4058</span>,</div><div class="line">  <span class="attr">code</span>: <span class="string">'ENOENT'</span>,</div><div class="line">  <span class="attr">syscall</span>: <span class="string">'open'</span>,</div><div class="line">  <span class="attr">path</span>: <span class="string">'F:\\workspace\\hero-admin\\common.js'</span> </div><div class="line">  <span class="comment">//可以看到此时请求的路径  ../hero-admin/common.js  是相对于 app 目录而言的</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果我们改下readFile的请求路径 </p>
<p>还在app 目录下运行   node path/a.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="comment">//相对于app当前目录，此时就可以得打文件的内容</span></div><div class="line">fs.readFile(<span class="string">'./hero-admin/common.js'</span>,<span class="string">'utf-8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err);</div><div class="line">    <span class="built_in">console</span>.log(data);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>根据以上，我们可以得出结论</p>
<p><strong>./     和    ../     是相对于</strong>启动服务器所在路径<strong>为基准的，而不是被启动的文件所在的路径为基准 </strong></p>
<p>这个是我们需要注意的一点，node中的文件的路径都是相对于启动node终端的那个目录为基准的，重要事情说两遍</p>
<p>同样包括如果我们引入的模块中也有相对路径的引用，此时，引用的模块中的路径还是相对于启动node终端的那个目录为基准的，重要事情说三遍</p>
<p><strong>当然以上仅仅指的是文件的路径引用，会受到node启用终端的位置不同而受到影响，但是定义的模块不会受node终端启用的影响，这个稍后会有demo解释</strong></p>
<p>2.3  /  代表服务器所在磁盘的根目录</p>
<p>修改readFile请求的路径</p>
<p>还在app 目录下运行   node path/a.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line">fs.readFile(<span class="string">'/hero-admin/common.js'</span>,<span class="string">'utf-8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err);</div><div class="line">    <span class="built_in">console</span>.log(data);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&#123; <span class="attr">Error</span>: ENOENT: no such file or directory, open <span class="string">'F:\hero-admin\common.js'</span></div><div class="line">    at <span class="built_in">Error</span> (native)</div><div class="line">  errno: <span class="number">-4058</span>,</div><div class="line">  <span class="attr">code</span>: <span class="string">'ENOENT'</span>,</div><div class="line">  <span class="attr">syscall</span>: <span class="string">'open'</span>,</div><div class="line">  <span class="attr">path</span>: <span class="string">'F:\\hero-admin\\common.js'</span> </div><div class="line">  <span class="comment">//可以看到服务器去F盘根目录去寻找这个文件了</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.4  但是我们在实际开发中总是避免不了对文件的路径的改变和移动，使得我们的项目结构更加清晰，或者说启动服务器位置不同，这个时候对于文件的相对路径问题如何解决？</p>
<p>还是以上目录结构  a.js 文件如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="built_in">console</span>.log(__dirname);</div><div class="line"><span class="built_in">console</span>.log(path.join(__dirname,<span class="string">'../02hero-admin/common.js'</span>));</div><div class="line"></div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line">fs.readFile(path.join(__dirname,<span class="string">'../02hero-admin/common.js'</span>),<span class="string">'utf-8'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="built_in">console</span>.log(err);</div><div class="line">    <span class="built_in">console</span>.log(data);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>我们在path目录下执行 node a.js   和我们在app目录下执行  node path/a.js</p>
<p>输出的结果都是一样的</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">F:\workspace\app\path</div><div class="line">F:\workspace\app\hero-admin\common.js</div><div class="line">console.log('this is some data from lib')</div></pre></td></tr></table></figure>
<p>由此可见，我们可以利用 __dirname不受启动服务其所在路径的影响的这个特性，使用绝对路径来动态读取文件内容,</p>
<p><strong>这个时候无论我们在任何位置启用a.js文件，路径问题就不在有了</strong></p>
<h3 id="3-对于模块的的引用的路径，不会受到启动nodejs终端的不同路径影响"><a href="#3-对于模块的的引用的路径，不会受到启动nodejs终端的不同路径影响" class="headerlink" title="3 对于模块的的引用的路径，不会受到启动nodejs终端的不同路径影响"></a>3 对于模块的的引用的路径，不会受到启动nodejs终端的不同路径影响</h3><p>我们队目录结构稍微做一下修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">F : </div><div class="line">	-workspace </div><div class="line">    	-app</div><div class="line">    		-hero-admin</div><div class="line">    			-common.js</div><div class="line">    			-myModule.js</div><div class="line">    		-path</div><div class="line">    			-a.js</div></pre></td></tr></table></figure>
<p>myModule.js   我们就简单的返回一个对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;<span class="attr">name</span>:<span class="string">"Jhon"</span>,<span class="attr">age</span>:<span class="number">14</span>&#125;;</div></pre></td></tr></table></figure>
<p>a.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ret = <span class="built_in">require</span>(<span class="string">'../02hero-admin/myModule'</span>);</div><div class="line"><span class="built_in">console</span>.log(ret);</div></pre></td></tr></table></figure>
<p>这个时候，无论我们是在任何目录启动node终端执行 a.js  都可以引用到myModule.js这个模块</p>
<p><strong>也就是说模块的引用永远都是相对于a.js文件的，而文件的引用却是相对于启用node终端的路径</strong></p>
<p>path目录下执行  node a.js   以及  app目录下执行   node path/a.js  终端输出如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123; name: &apos;Jhon&apos;, age: 14 &#125;</div></pre></td></tr></table></figure>
<h3 id="4-平常我们在部署项目的时候，路径的引用问题是一个令人头疼的问题，不过最基本的原理搞明白了，问题还是可以迎刃而解的。"><a href="#4-平常我们在部署项目的时候，路径的引用问题是一个令人头疼的问题，不过最基本的原理搞明白了，问题还是可以迎刃而解的。" class="headerlink" title="4 平常我们在部署项目的时候，路径的引用问题是一个令人头疼的问题，不过最基本的原理搞明白了，问题还是可以迎刃而解的。"></a>4 平常我们在部署项目的时候，路径的引用问题是一个令人头疼的问题，不过最基本的原理搞明白了，问题还是可以迎刃而解的。</h3>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/15/128NodeJsEvent/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/15/128NodeJsEvent/" itemprop="url">
                  NodeJs Event
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-15T12:36:00+08:00">
                2017-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index">
                    <span itemprop="name">nodejs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1 events事件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//引入events模块并创建eventEmitter对象</span></div><div class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">'events'</span>);</div><div class="line"><span class="keyword">var</span> eventEmitter = <span class="keyword">new</span> events.EventEmitter();</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//声明事件函数</span></div><div class="line"><span class="keyword">var</span> eventNameHandle = <span class="function"><span class="keyword">function</span> <span class="title">eventName</span>(<span class="params"></span>)</span>&#123;&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//绑定事件处理程序，并触发执行</span></div><div class="line">eventEmitter.on(<span class="string">'eventName'</span>,eventNameHandle);</div><div class="line">eventEmitter.emit(<span class="string">'eventName'</span>);</div></pre></td></tr></table></figure>
<p>2 我们可以输出 events 模块  console.log(events); 查看其所包含内容</p>
<p>events模块只提供了一个对象: events.EventEmitter .该对象的核心就是事件的触发和事件的监听的整体封装；</p>
<p>events.EventEmitter 对象提供了多个属性，比如on可以绑定事件 emit用于触发事件,当事件触发的时候，注册到这个事件的监听器会被依次调用，事件参数作为回调函数参数传递；</p>
<p>on(event,listener)   emit(event,arg1,arg2,····)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">'events'</span>);</div><div class="line"><span class="keyword">var</span> eventsEmitter = <span class="keyword">new</span> events.EventEmitter();</div><div class="line">eventsEmitter.on(<span class="string">"eventName"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">arg1,arg2</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"listener1"</span>,arg1,arg2);</div><div class="line">&#125;);</div><div class="line">eventsEmitter.on(<span class="string">"eventName"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">arg1,arg2</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"listener2"</span>,arg1,arg2);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//以下给同一个事件注册了两个监听器</span></div><div class="line">eventsEmitter.on(<span class="string">"anotherName"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">arg1,arg2</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"listener3"</span>,arg1,arg2);</div><div class="line">&#125;);</div><div class="line">eventsEmitter.emit(<span class="string">'eventName'</span>,<span class="string">'argone'</span>,<span class="string">'argtwo'</span>);</div><div class="line"><span class="comment">//eventsEmitter.emit('anothertName','argone','argtwo');</span></div></pre></td></tr></table></figure>
<p>once(event,listener)  为指定事件注册一个单次监听器，即监听器最多只能触发一次，触发之后马上解绑</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">'events'</span>);</div><div class="line"><span class="keyword">var</span> eventsEmitter = <span class="keyword">new</span> events.EventEmitter();</div><div class="line">eventsEmitter.once(<span class="string">"name1"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">arg1,arg2</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"listener4"</span>,arg1,arg2);</div><div class="line">&#125;);</div><div class="line">eventsEmitter.emit(<span class="string">'name1'</span>,<span class="string">'argone'</span>,<span class="string">'argtwo'</span>);</div><div class="line">eventsEmitter.emit(<span class="string">'name1'</span>,<span class="string">'argone'</span>,<span class="string">'argtwo'</span>);</div><div class="line"><span class="comment">//在node终端执行的时候，即使emit了两次，该事件监听器也只执行一次，而on绑定的事件可以多次执行</span></div></pre></td></tr></table></figure>
<p>addListener(event,listener) 给指定事件添加一个事件监听器，到监听器数组的尾部</p>
<p>removeListener(event,listener) 删除指定事件的listener，此操作会影响处于被删监听器之后的那些监听器的索引</p>
<p>listenerCount(emmit,listener)  emmit是 new events.EventEmitter()对象，所有的事件都是通过该对象进行绑定，触发等操作。该方法可以返回指定事件的监听器数量</p>
<p>listeners(event)  该方法返回某个事件上的监听器所组成的数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">'events'</span>);</div><div class="line"><span class="keyword">var</span> emmit = <span class="keyword">new</span> events.EventEmitter();</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">listener1</span> (<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"this is listernr1"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">listener2</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"this is listener2"</span>);</div><div class="line">&#125;</div><div class="line">emmit.on(<span class="string">'event1'</span>,listener1);</div><div class="line">emmit.on(<span class="string">'event1'</span>,listener2);<span class="comment">//给event1注册两个监听器，listenerConut可以得到该事件的监听器数量</span></div><div class="line"><span class="comment">//let count = emmit.listenerCount(emmit,'event1');</span></div><div class="line"><span class="keyword">let</span> count = <span class="built_in">require</span>(<span class="string">'events'</span>).EventEmitter.listenerCount(emmit,<span class="string">'event1'</span>);</div><div class="line"><span class="built_in">console</span>.log(count);<span class="comment">//2</span></div><div class="line"><span class="built_in">console</span>.log(emmit.listeners(<span class="string">'event1'</span>));</div><div class="line"><span class="comment">//[ [Function: listener1], [Function: listener2] ]</span></div><div class="line">emmit.emit(<span class="string">'event1'</span>);</div><div class="line">emmit.removeListener(<span class="string">'event1'</span>,listener1);</div><div class="line">emmit.on(<span class="string">'event1'</span>,listener1);<span class="comment">//这个监听事件被移除，不会再次被触发</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/15/94-apply  call  bind 对比分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/15/94-apply  call  bind 对比分析/" itemprop="url">
                  the difference between null and undefined
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-15T12:36:00+08:00">
                2017-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##apply  call  bind 对比分析</p>
<h2 id="1-基本语法-第一个参数必须传入一个对象"><a href="#1-基本语法-第一个参数必须传入一个对象" class="headerlink" title="1 基本语法,第一个参数必须传入一个对象"></a>1 基本语法,第一个参数必须传入一个对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fun.bind(thisArg[, arg1[, arg2[, ...]]])</div><div class="line">fun.call(thisArg[, arg1[, arg2[, ...]]])</div><div class="line">fun.apply(thisArg[, argsArray])</div><div class="line"><span class="comment">//bind call  apply可以改变原来的 fn 函数以 thisarg为对象进行执行</span></div><div class="line"><span class="comment">//第一个参数是代表fun函数执行的this指向</span></div></pre></td></tr></table></figure>
<h2 id="2-三者之间的区别"><a href="#2-三者之间的区别" class="headerlink" title="2 三者之间的区别"></a>2 三者之间的区别</h2><p>2.1 bind只绑定方法执行的对象，并不执行方法，改变的是函数的this指向；根据bind的这个特性，经常会结合setTimeout执行</p>
<p>2.2 call apply绑定方法的执行对象的同时，也会直接执行方法；</p>
<p>2.2.1  fun.apply(thisArg[, argsArray])</p>
<p>thisArg<br>在 fun 函数运行时指定的 this 值。需要注意的是，指定的 this 值并不一定是该函数执行时真正的 this 值，如果这个函数处于非严格模式下，则指定为 null 或 undefined 时会自动指向全局对象（浏览器中就是window对象），同时值为原始值（数字，字符串，布尔值）的 this 会指向该原始值的自动包装对象。<br>argsArray<br>一个<strong>数组</strong>或者<strong>类数组</strong> 对象，其中的<strong>数组元素将作为单独的参数传给 fun 函数</strong>  。如果该参数的值为null 或 undefined，则表示不需要传入任何参数。从ECMAScript 5 开始可以使用类数组对象。浏览器兼容性请参阅本文底部内容。</p>
<p>同时除了可以传入一个数组，也可以传入arguments,代表当前函数的参数的一个<strong>类数组</strong> </p>
<p>如果 argsArray 不是一个有效的数组或者不是 arguments 对象，那么将导致一个 TypeError。<br>如果没有提供 argsArray 和 thisArg 任何一个参数，那么 Global 对象将被用作 thisArg， 并且无法被传递任何参数。</p>
<p>2.2.2 fun.call(thisArg[, arg1[, arg2[, …]]])</p>
<p>如果thisArg指定为null<code>和</code>undefined<code>的</code>this值会自动指向全局对象(浏览器中就是window对象)，同时值为原始值(数字，字符串，布尔值)的<code>this</code>会指向该原始值的自动包装对象。</p>
<p>2.3 主要改变函数体执行的时候，函数体内this的指向；</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> name = <span class="string">"Jhon"</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getName</span> (<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> obj = &#123;</div><div class="line">        <span class="attr">name</span>:<span class="string">"JiM"</span></div><div class="line">    &#125;</div><div class="line">    getName();<span class="comment">//Jhon</span></div><div class="line">    getName.apply(obj);<span class="comment">//JiM</span></div><div class="line">    getName.call(obj);<span class="comment">//JiM</span></div><div class="line">    getName.bind(obj);<span class="comment">//不会执行getName函数</span></div><div class="line">    getName.bind(obj)(); <span class="comment">//JiM</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>2.3 call方法传入的参数是参数列表形式的，apply传入的参数<strong>必须是数组</strong> 形式的</p>
<ul>
<li>apply参数数组化的应用场景：求数组最值</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">	<span class="keyword">var</span> arr= [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">777</span>]</div><div class="line"><span class="comment">//  var max = Math.max.apply(null,arr);//777</span></div><div class="line">    <span class="keyword">var</span> max = <span class="built_in">Math</span>.max.call(<span class="literal">null</span>,arr);<span class="comment">//NaN</span></div><div class="line"> <span class="comment">// var max = Math.max(arr) ; //NaN</span></div><div class="line">    <span class="built_in">console</span>.log(max);</div><div class="line"><span class="comment">//  这是apply方法的特性，apply方法第二个参数为参数的数组，虽然我们传入的是数组参数apply会将一个数组转化为一个参数接一个参数的传递给方法。但是call并不会</span></div></pre></td></tr></table></figure>
<ul>
<li>如何将一个数组追加到另外一个数组呢？</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> arr2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</div><div class="line"><span class="keyword">var</span> arr3 = arr1.concat(arr2);</div><div class="line"><span class="comment">//是的，这种方法可以，但是问题是concat方法并不会改变原来的数组，而是会返回一个新的元素</span></div></pre></td></tr></table></figure>
<p>或者你也会这么做</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> arr2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</div><div class="line"><span class="comment">//arr1.push(arr2)//这么做是不行的,push会将arr2整体添加到arr1中</span></div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; arr2.length;i++)&#123;</div><div class="line">  	arr1.push(arr2[i]);</div><div class="line">&#125;</div><div class="line"><span class="comment">//这么做也可以，通过循环，但是挺麻烦</span></div></pre></td></tr></table></figure>
<p>看看apply参数数组化的优势 apply会将数组拆分，将每个元素传入调用的函数push</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"> <span class="keyword">var</span> arr2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</div><div class="line"> arr1.push.apply(arr1,arr2)	<span class="comment">//apply起了决定性的作用，将传入的数组或者类数组中的参数一个个的分开</span></div><div class="line"> <span class="comment">//    arr1.push(arr2)  //这么做不行，直接将arr2整体添加给了arr1 </span></div><div class="line"><span class="built_in">console</span>.dir(arr1);</div></pre></td></tr></table></figure>
<ul>
<li>如何将一个 类数组对象 添加到另外一个  对象 呢？</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arrLike = &#123;</div><div class="line">     <span class="number">0</span>:<span class="string">"name"</span>,</div><div class="line">     <span class="number">1</span>:<span class="string">"age"</span>,</div><div class="line">     <span class="number">2</span>:<span class="string">"address"</span>,</div><div class="line">     <span class="attr">length</span>:<span class="number">3</span>      </div><div class="line">  <span class="comment">//如果将类数组作为apply的参数传入(因为apply第二个参数必须是数组)，类数组必须有length属性,如果没有该属性，那么类数组中的值不会被push进去;</span></div><div class="line"> &#125;</div><div class="line"> <span class="keyword">var</span> obj = &#123; &#125;;</div><div class="line"> <span class="built_in">Array</span>.prototype.push.apply(obj,arrLike);  <span class="comment">//关键还是apply方法会将传入的类数组元素一个个传递给push，然后push方法就可以将所有的元素以单独的形式添加给obj</span></div><div class="line"> <span class="built_in">console</span>.dir(obj);</div></pre></td></tr></table></figure>
<p>下面代码可以看下，看下apply的参数对于数组以及类数组的要求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">var</span> obj1 = &#123;</div><div class="line">        <span class="attr">name</span>:<span class="string">"Jhon"</span>,</div><div class="line">        <span class="attr">age</span>:<span class="number">13</span>,</div><div class="line">        <span class="attr">address</span>:<span class="string">"American"</span>,</div><div class="line">        <span class="number">1</span>:<span class="string">"JiM"</span>,</div><div class="line">        <span class="attr">other</span>:&#123;</div><div class="line">            <span class="attr">gender</span>:<span class="string">"man"</span></div><div class="line">        &#125;,</div><div class="line"><span class="comment">//      length:4	</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> obj2 = &#123;&#125;;</div><div class="line">    <span class="built_in">Array</span>.prototype.push.apply(obj2,obj1)</div><div class="line">    <span class="built_in">console</span>.dir(obj2);</div></pre></td></tr></table></figure>
<ul>
<li>apply操作DOM元素   NodeList类数组</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> divs = <span class="built_in">document</span>.querySelectorAll(<span class="string">"div"</span>);</div><div class="line">     <span class="built_in">console</span>.dir(divs);<span class="comment">//这是一个类数组</span></div><div class="line"> 	<span class="built_in">console</span>.dir(divs[<span class="number">0</span>]);</div><div class="line">    <span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line">     <span class="built_in">Array</span>.prototype.push.apply(obj,divs);<span class="comment">//push+obj+apply可以将DOM NodeList转化为对象</span></div><div class="line">     <span class="built_in">console</span>.dir(obj);</div><div class="line">     <span class="built_in">console</span>.dir(obj[<span class="number">0</span>]);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>bind</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">fn, obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> fn.apply(obj, <span class="built_in">arguments</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    <span class="attr">a</span>: <span class="number">20</span>,</div><div class="line">    <span class="attr">getA</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        setTimeout(bind(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</div><div class="line">        &#125;, <span class="keyword">this</span>), <span class="number">1000</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">obj.getA();</div><div class="line"><span class="comment">//---------------------------------</span></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    <span class="attr">a</span>: <span class="number">20</span>,</div><div class="line">    <span class="attr">getA</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</div><div class="line">        &#125;.bind(<span class="keyword">this</span>), <span class="number">1000</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3-this的指向"><a href="#3-this的指向" class="headerlink" title="3  this的指向"></a>3  this的指向</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1 非严格模式下，this默认指向全局对象，call/apply显式指定this参数时也会强制转换参数为对象（如果不是对象）。其中，null/undefined被替换为全局对象，基础类型被转换为包装对象。</span></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">nsm</span>(<span class="params"></span>) </span>&#123;<span class="built_in">console</span>.log(<span class="keyword">this</span>);&#125;</div><div class="line">    nsm(); <span class="comment">// Window&#123;top: xxxx&#125;</span></div><div class="line">    nsm.call(<span class="literal">null</span>/<span class="literal">undefined</span>); <span class="comment">// Window&#123;top: xxxx&#125;</span></div><div class="line">    nsm.call(<span class="number">1</span>); <span class="comment">// Number &#123;[[PrimitiveValue]]: 1&#125;</span></div><div class="line">    nsm.call(<span class="string">'str'</span>); <span class="comment">// String &#123;0: "s", 1: "t", 2: "r", length: 3, [[PrimitiveValue]]: "str"&#125;</span></div><div class="line">    nsm.call(<span class="literal">true</span>); <span class="comment">// Boolean &#123;[[PrimitiveValue]]: true&#125;</span></div><div class="line"></div><div class="line"><span class="comment">//----------------------------------------------------------------------------------------</span></div><div class="line"></div><div class="line"><span class="comment">//2 严格模式下，this默认为undefined，且call/apply显式指定this参数时也不会有强制转换</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sm</span>(<span class="params"></span>) </span>&#123;<span class="string">'use strict'</span>; <span class="built_in">console</span>.log(<span class="keyword">this</span>);&#125;</div><div class="line">    sm(); <span class="comment">// undefined</span></div><div class="line">    sm.call(<span class="literal">null</span>); <span class="comment">// null</span></div><div class="line">    sm.call(<span class="literal">undefined</span>); <span class="comment">// undefined</span></div><div class="line">    sm.call(<span class="number">1</span>); <span class="comment">// 1</span></div><div class="line">    sm.call(<span class="string">'str'</span>); <span class="comment">// str</span></div><div class="line">    sm.call(<span class="literal">true</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/08/131NodeJsFS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/08/131NodeJsFS/" itemprop="url">
                  NodeJsFileSystem WriteFileAndReadFile
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-08T12:36:00+08:00">
                2017-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index">
                    <span itemprop="name">nodejs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="FileSystem"><a href="#FileSystem" class="headerlink" title="FileSystem"></a>FileSystem</h3><p>文件 I/O 是由简单封装的标准 POSIX 函数提供的。 通过 require(‘fs’)使用该模块。 <strong>所有的方法都有异步和同步的形式。</strong></p>
<ul>
<li><p>异步形式始终以完成回调作为它最后一个参数。 传给完成回调的参数取决于具体方法，但第一个参数总是留给异常。 如果操作成功完成，则第一个参数会是 null或 undefined，如果操作失败，则第一个参数将是一个错误对象；</p>
<p>需要注意一点，异步操作无法通过try-catch来捕获异常</p>
</li>
<li><p>当使用同步形式时，任何异常都会被立即抛出。 可以使用 try/catch 来处理异常，或让它们往上冒泡。</p>
</li>
</ul>
<h3 id="nodejs-fs"><a href="#nodejs-fs" class="headerlink" title="nodejs fs"></a>nodejs fs</h3><p>1 读取文件操作readFile(file,options,callback)</p>
<ul>
<li>file是要读取的文件的路径</li>
<li>options<ul>
<li>encoding  <string> | null     //默认值是null,所以如果不指定编码方式，读取文件的结果<strong>默认返回的值是二进制数据</strong>,返回的结果会作为参数传递给callback回调函数</string></li>
<li>flag  <string>  默认是  ‘r’</string></li>
</ul>
</li>
<li>callback 回调函数又有两个参数，第一个参数是error对象，第二个参数是读取到的数据<ul>
<li>如果读取文件成功，err返回null  data返回读取到的文件数据;(如果字符编码未指定，则返回原始的buffer数据)</li>
<li>如果读取文件失败，err返回一个错误对象，data返回undefined;</li>
</ul>
</li>
<li>注意读取文件的内容返回的结果要么是<strong>Buffer类型</strong>的数据，要么是<strong>字符串类型</strong>的数据</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//创建文件读取对象</span></div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line">fs.readFile(<span class="string">'input.txt'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123; <span class="comment">//假如input.txt里面的内容是  hello world</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);<span class="comment">//我们可以打印出来回调函数的参数进行查看，即使文件读取失败，回调函数也会执行</span></div><div class="line">  <span class="built_in">console</span>.log(err);</div><div class="line">  <span class="built_in">console</span>.log(data);<span class="comment">//readFile返回的data数据是buffer类型的数据</span></div><div class="line">  <span class="keyword">if</span>(err)&#123;</div><div class="line">    <span class="built_in">console</span>.log(err.stack);</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(data.toString());<span class="comment">//需要调用toString方法转化为字符串</span></div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"program is done"</span>);</div><div class="line"><span class="comment">//program is done</span></div><div class="line"><span class="comment">//hello world </span></div><div class="line"><span class="comment">//程序无阻塞运行</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//readFile语法</span></div><div class="line">fs.readFile(<span class="string">'etc/passwd'</span>,(err,data)=&gt;&#123;</div><div class="line">  <span class="keyword">if</span>(err) <span class="keyword">throw</span> err;  <span class="comment">//使用箭头函数可以使代码更加简洁</span></div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//readFile用于异步读取文件内容，</span></div></pre></td></tr></table></figure>
<p>2 写入文件的操作writeFile(file,data,[option],callback)</p>
<ul>
<li>file可以是文件名或者文件描述</li>
<li>data是异步地写入的数据内容，可以是一个string或者buffer</li>
<li>option 编码格式，如果data是一个buffer,则默认encoding是utf-8</li>
<li>callback 回调函数,该回调函数里面只有一个参数就是err错误处理对象，如果写入成功err返回null</li>
</ul>
<p>看下面这个简单的例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line">fs.writeFile(<span class="string">'../write.txtf'</span>,<span class="string">'hello nodejs'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (err)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">"写入文件失败"</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"写入文件成功"</span>);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"pro is done"</span>);</div></pre></td></tr></table></figure>
<p>需要注意的是，我们只能写入字符串或者Buffer类型的数据，如果写入复杂数据类型</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fs.writeFileSync(<span class="string">'./text'</span>,<span class="string">' sync write'</span>); <span class="comment">// 写入文件的内容是    sync write  </span></div><div class="line">fs.writeFileSync(<span class="string">'./text.txt'</span>,&#123;<span class="attr">name</span>:<span class="string">"Jhon"</span>&#125;);<span class="comment">//写入文件的内容是[object Object]</span></div><div class="line">fs.writeFileSync(<span class="string">'./text.txt'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);<span class="comment">//写入文件的内容是  function()&#123;&#125; </span></div><div class="line">fs.writeFileSync(<span class="string">'./text.txt'</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]); <span class="comment">//写入文件的内容是  1,2,3</span></div><div class="line">fs.writeFileSync(<span class="string">'./text.txt'</span>,<span class="number">1</span>);<span class="comment">//写入文件的内容是 1</span></div></pre></td></tr></table></figure>
<p>3 以上文件的读写都是异步进行的，不会阻塞程序的执行，同时我们在日常工作中通过服务器端的数据的读写也会经常用到这两个API </p>
<p>4 对于异步 的任务，很多时候，每个任务的执行先后顺序是无法控制的，那么如何去解决这个问题？</p>
<p><strong>此时，如果需要异步任务按照我们的意愿顺序进行，那么则需要将形成异步嵌套，形成一个回调链</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/28/167NodeJs事件驱动/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiM-W">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JiM-W">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/28/167NodeJs事件驱动/" itemprop="url">
                  NodeJs 事件驱动
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-28T12:36:00+08:00">
                2016-12-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nodejs/" itemprop="url" rel="index">
                    <span itemprop="name">nodejs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-在了解nodejs的事件驱动模型的时候，先来看下传统线程网络模型"><a href="#1-在了解nodejs的事件驱动模型的时候，先来看下传统线程网络模型" class="headerlink" title="1 在了解nodejs的事件驱动模型的时候，先来看下传统线程网络模型"></a>1 在了解nodejs的事件驱动模型的时候，先来看下传统线程网络模型</h3><p>1.1 <strong>传统线程网络模型</strong></p>
<p>发起请求，请求进入web服务器(IIS、Apache)之后,会在线程池中分配一个线程来线性同步完成请求处理，直到请求处理完成并发出响应,结束之后线程池回收。</p>
<p>这就会就会带来以下几个问题 :</p>
<ul>
<li>由于线程池中线程个数有限,对于频繁请求时,就会出现等待,严重的甚至会把服务器挂掉</li>
<li>同时线程的增多也会占用大量的 CPU 时间来处理内存上下文切换， 而且还容易遭受低速连接攻击</li>
<li>对于高并发的时候,为了防止出现脏数据就会使用锁来解决,一些I/O事务可能消耗很长得时间,这样就会出现一些线程等待,效率低下</li>
</ul>
<p>1.2 <strong>Node.Js使用事件驱动模型</strong></p>
<p>当web server接收到请求，就把它关闭然后进行处理，然后去服务下一个web请求。当这个请求完成，它被放回处理队列，当到达队列开头，这个结果被返回给用户。这个模型非常高效可扩展性非常强，因为webserver一直接受请求而不等待任何读写操作。（这也被称之为非阻塞式IO或者事件驱动IO）</p>
<p>Node.js 的异步机制是基于事件的，所有的   磁盘 I/O 、   网络通信、  数据库查询   客户端的请求  都以<strong>非阻塞</strong>的方式请求，返回的结果由事件循环来处理。如图 描述了这个机制。Node.js 进程在同一时刻只会处理一个事件，完成后立即进入事件循环检查并处理后面的事件。<br>这样做的好处是CPU 和内存在同一时间集中处理一件事，同时尽可能让耗时的 I/O 操作并行执行</p>
<p>Nodejs事假驱动机制是通过Nodejs内部通过 单线程高效率地 维护事件队列来实现的，没有多线程的资源占用和频繁的上下文切换</p>
<ul>
<li>像<a href="http://lib.csdn.net/base/javase" target="_blank" rel="external">Java</a>、<a href="http://lib.csdn.net/base/python" target="_blank" rel="external">Python</a>这个可以具有多线程的语言。多线程同步模式是这样的，将cpu分成几个线程，每个线程同步运行。 </li>
<li>而node.js采用<strong>单线程异步非阻塞</strong>模式，也就是说每一个计算独占cpu，遇到I/O请求不阻塞后面的计算，当I/O完成后，以事件的方式通知，继续执行计算</li>
</ul>
<p>1.3 <strong>同步与异步</strong></p>
<p>同步和异步关注的是消息通信机制 (synchronous communication/ asynchronous communication)</p>
<ul>
<li>所谓同步，就是在发出一个调用之后，在没有得到结果，该调用就不会返回；得到返回值之后，该调用返回</li>
<li>所谓异步，就是在发出一个调用之后，直接返回该调用，所以没有返回结果；也就是说当一个异步调用发出后，调用者不会立刻得到结果，而是在调用发出后，被调用者通过状态的变化通知调用者，或者通过回调函数处理这个调用</li>
</ul>
<p>举个通俗的例子：你打电话问书店老板有没有《分布式系统》这本书，如果是同步通信机制，书店老板会说，你稍等，”我查一下”，然后开始查啊查，等查好了（可能是5秒，也可能是一天）告诉你结果（返回结果）。而异步通信机制，书店老板直接告诉你我查一下啊，查好了打电话给你，然后直接挂电话了（不返回结果）。然后查好了，他会主动打电话给你。在这里老板通过“回电”这种方式来回调。</p>
<p>异步操作的时候回调函数的第一个参数通常是上一步传入的错误对象，异步操作不能使用try-catch捕获异常，因为在回调函数运行的时候，上一步的操作早就结束了，错误的栈也已经不存在了，所以只能将错误数据传递给回调函数进行处理</p>
<p>1.4 <strong>阻塞与非阻塞</strong></p>
<p>常见I/O阻塞  磁盘读取 、   网络通信、  数据库查询   客户端的请求</p>
<p>阻塞和非阻塞关注的是程序在<strong>等待调用结果（消息，返回值）时的状态.</strong></p>
<ul>
<li>阻塞调用是指调用结果返回之前，当前线程会被挂起。调用线程只有在得到结果之后才会返回。 </li>
<li>非阻塞调用指在不能立刻得到结果之前，该调用不会阻塞当前线程。</li>
</ul>
<p>还是上面的例子，你打电话问书店老板有没有《分布式系统》这本书，你如果是阻塞式调用，你会一直把自己“挂起”，直到得到这本书有没有的结果，如果是非阻塞式调用，你不管老板有没有告诉你，你自己先一边去玩了，<br>当然你也要偶尔过几分钟check一下老板有没有返回结果。在这里阻塞与非阻塞与是否同步异步无关。跟老板通过什么方式回答你结果无关。</p>
<p>1.5  线程和进程</p>
<ul>
<li>多线程单进程     </li>
</ul>
<p>多线程的 设计之初就是为了在共享的内存程序空间中，实现并行 处理任务，从而达到充分利用CPU的效果。多线程的缺点就是在于执行的时候上下文的切换开销比较大，使得程序的编写和调用复杂化</p>
<ul>
<li>单线程多进程</li>
</ul>
<p>为了避免多线程造成的使用不便的问题，有的语言选择使用单线程保持调用的简单化，采用启动多进程的方式来达到充分利用CPU和提升整体的并行处理能力。它的缺点在于业务逻辑复杂的时候，涉及多个I/O操作的时候，因为业务逻辑不能分布到多个进程之间，事务处理时长要远远大于多线程模式。</p>
<p>2 代码实现，理解上述概念</p>
<p>2.1 阻塞与非阻塞</p>
<p>假如hello.txt</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hello world</div></pre></td></tr></table></figure>
<p>以下程序会<strong>非阻塞运行</strong>，当我们发起一个文件读取操作的时候，不会阻塞js代码的执行，后续的js代码会继续执行，当文件读取完毕之后，会调用回调函数；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line">fs.readFile(<span class="string">'hello.txt'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(err)&#123;</div><div class="line">        <span class="built_in">console</span>.log(err.stack);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(data.toString());</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"pro is don"</span>);</div><div class="line"><span class="comment">//pro is don </span></div><div class="line"><span class="comment">//hello world</span></div></pre></td></tr></table></figure>
<p>以下程序会<strong>阻塞运行</strong>，当我们发起一个文件读取操作的时候，会阻塞js代码的执行，当文件读取完毕之后，后续的js代码才开始执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</div><div class="line"><span class="keyword">var</span> data = fs.readFileSync(<span class="string">'hello.js'</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(data.toString());</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"pro is done"</span>);</div><div class="line"><span class="comment">//hello world</span></div><div class="line"><span class="comment">//pro is don</span></div></pre></td></tr></table></figure>
<p>2.2  事件循环线程与事件队列</p>
<p>对于遇到I/O操作，node.js不会停止后面的文件的内容的执行，会继续执行后续代码，然后另外一个线程处理I/O，处理完毕之后，将回调函数放入事件队列等待执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"begin"</span>);</div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Timeout1"</span>);</div><div class="line">&#125;,<span class="number">100</span>)</div><div class="line">fs.readFile(<span class="string">'hello.tet'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(err)&#123;</div><div class="line">        <span class="built_in">console</span>.log(err.stack);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(data.toString());</div><div class="line">&#125;);</div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Timeout2"</span>);</div><div class="line">&#125;,<span class="number">0</span>)</div><div class="line"><span class="comment">//即使设置为0，最少也会有5ms的延迟</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">"end"</span>);</div></pre></td></tr></table></figure>
<p>输出如下</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">begin </div><div class="line">end </div><div class="line">timeout2</div><div class="line">timeout1</div><div class="line">helloworld</div></pre></td></tr></table></figure>
<p>需要注意的是 setTimeout和readFile的操作，会将回调函数放入事件队列，回调函数执行的顺序取决于文件读取的速度，以及延时任务的时间的大小比较；</p>
<p>通俗来讲，假如文件读取的用了200ms ，那么执行顺序就是上面的输出结果</p>
<p>假如文件读取用了50ms，那么执行顺序就是</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">begin </div><div class="line">end </div><div class="line">timeout2</div><div class="line">helloworld</div><div class="line">timeout1</div></pre></td></tr></table></figure>
<p>3 </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="JiM-W" />
          <p class="site-author-name" itemprop="name">JiM-W</p>
           
              <p class="site-description motion-element" itemprop="description">keep fighting！</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">178</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">51</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">83</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JiM-W</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


  

</body>
</html>
